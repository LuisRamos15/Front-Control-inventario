<div *ngIf="open" class="pm-overlay" (click)="onCancel()" (keydown)="esc($event)" tabindex="0">
  <div class="pm-modal" (click)="$event.stopPropagation()" role="dialog" aria-modal="true">
     <div class="modal-header">
       <h5>{{ isEdit ? 'Editar Producto' : 'Nuevo Producto' }}</h5>
       <p>Complete la información del producto</p>
       <button type="button" class="icon-close" (click)="onCancel()">&times;</button>
     </div>
    <form [formGroup]="form" (ngSubmit)="onSubmit()" class="modal-form" novalidate>
      <div class="grid">
        <div class="form-field">
          <label for="sku">SKU</label>
          <input id="sku" type="text" formControlName="sku" placeholder="SKU-001" [readOnly]="isEdit" />
          <small class="help" *ngIf="control('sku').touched && control('sku').invalid">
            Ingrese un SKU válido.
          </small>
        </div>
        <div class="form-field">
          <label for="nombre">Nombre del Producto</label>
          <input id="nombre" type="text" formControlName="nombre" placeholder="Nombre del producto" autofocus />
          <small class="help" *ngIf="control('nombre').touched && control('nombre').invalid">
            El nombre es obligatorio.
          </small>
        </div>
        <div class="form-field form-span">
          <label for="categoria">Categoría</label>
          <input id="categoria" type="text" formControlName="categoria" placeholder="Escribe o selecciona" list="categorias" />
        </div>
        <div class="form-field">
          <label for="min">Stock Mínimo</label>
          <div class="input-affix">
            <input id="min" type="number" formControlName="minimo" [readOnly]="true" />
            <span class="tag">Fijo en 10</span>
          </div>
        </div>
        <div class="form-field">
          <label for="max">Stock Máximo</label>
          <input id="max" type="number" formControlName="stockMaximo" min="0" inputmode="numeric" />
          <small class="help" *ngIf="control('stockMaximo').touched && control('stockMaximo').invalid">
            Debe ser un número >= 0 y mayor o igual al mínimo.
          </small>
        </div>
        <div class="form-field">
          <label for="stock">Stock</label>
          <input id="stock" type="number" formControlName="stock" min="0" inputmode="numeric" />
        </div>
        <div class="form-field">
          <label for="precio">Precio Unitario</label>
          <div class="input-prefix">
            <span>$</span>
            <input id="precio" type="number" formControlName="precioUnitario" min="0" step="0.01" inputmode="decimal" />
          </div>
          <small class="help" *ngIf="control('precioUnitario').touched && control('precioUnitario').invalid">
            Debe ser un valor >= 0.
          </small>
        </div>
        <div class="form-field form-span">
          <label for="descripcion">Descripción</label>
          <textarea id="descripcion" rows="3" formControlName="descripcion" placeholder="Opcional"></textarea>
        </div>
      </div>
      <div class="modal-actions">
        <button type="button" class="btn ghost" (click)="onCancel()">Cancelar</button>
        <button type="submit" class="btn primary" [disabled]="form.invalid || guardando">
          <span *ngIf="!guardando">Guardar Producto</span>
          <span *ngIf="guardando" class="loader"></span>
        </button>
      </div>
    </form>
  </div>
</div>
<datalist id="categorias">
  <option *ngFor="let c of categorias" [value]="c"></option>
</datalist>