<!-- Contenedor principal en card, respeta m√°rgenes del layout actual -->
<div class="inv-wrap">
  <div class="inv-header">
    <div class="inv-title">
      <div class="inv-icon"></div>
      <h2>Gesti√≥n de Inventario</h2>
    </div>
    <div class="inv-actions">
      <div class="inv-search">
         <input
           type="text"
           [(ngModel)]="buscando"
           placeholder="Buscar por nombre, SKU o categor√≠a..."
           aria-label="Buscar"
         />
          <button type="button" class="inv-search-icon" (click)="onBuscarChange()" title="Buscar">üîç</button>
      </div>
       <button class="inv-btn-primary" (click)="crearProducto()" *ngIf="canManageProductos">
         + Nuevo Producto
       </button>
    </div>
  </div>
  <div class="inv-card">
    <div class="inv-card-title">Productos Registrados</div>
     <div class="inv-table-wrap" [class.loading]="cargando">
        <table class="inv-table table table-striped align-middle">
         <thead>
           <tr>
             <th>SKU</th>
             <th>Nombre</th>
             <th>Categor√≠a</th>
             <th class="num">Stock Actual</th>
             <th class="num">Stock M√°ximo</th>
             <th class="num">Estado</th>
             <th class="num">Acciones</th>
           </tr>
         </thead>
         <tbody>
           <tr *ngIf="!cargando && filtrados.length === 0">
             <td colspan="7" class="empty">Sin productos.</td>
           </tr>
            <tr *ngFor="let p of filtrados; trackBy: trackById">
             <td>{{ p.sku }}</td>
             <td class="fw-semibold">{{ p.nombre }}</td>
             <td>{{ p.categoria || '' }}</td>
             <td class="num">{{ p?.stock ?? 0 }}</td>
             <td class="num">{{ p?.stockMaximo ?? 0 }}</td>
             <td class="num">
               <span
                 class="badge"
                 [class.badge-critico]="p?.estado === 'CRITICO'"
                 [class.badge-bajo]="p?.estado === 'BAJO'"
                 [class.badge-normal]="p?.estado === 'NORMAL'"
                 [class.badge-alto]="p?.estado === 'ALTO'"
               >
                 {{
                   p?.estado === 'CRITICO' ? 'Cr√≠tico' :
                   p?.estado === 'BAJO'    ? 'Bajo'    :
                   p?.estado === 'ALTO'    ? 'Alto'    : 'Normal'
                 }}
               </span>
             </td>
              <td class="num">
                <button class="btn-icon edit" title="Editar" *ngIf="canManageProductos" (click)="editar(p!)"></button>
                <button class="btn-icon del" title="Eliminar" *ngIf="canManageProductos" (click)="eliminar(p!)"></button>
              </td>
           </tr>
         </tbody>
       </table>
        <div class="spinner" *ngIf="cargando"></div>
       </div>
    </div>
 </div>

 <app-producto-modal
   [open]="modalOpen"
   [producto]="editTarget"
   (close)="onModalClosed()"
   (saved)="onModalSaved()">
 </app-producto-modal>