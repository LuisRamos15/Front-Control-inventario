<!-- Backdrop -->

<div class="mp-overlay" (click)="onCancel()"></div>

<!-- Caja modal -->

<div class="mp-modal" role="dialog" aria-modal="true">

<div class="mp-header">

<div class="mp-title">

<mat-icon class="mp-icon">add</mat-icon>

<h3>Registrar Movimiento</h3>

</div>

<button type="button" class="mp-close" (click)="onCancel()" aria-label="Cerrar">×</button>

</div>

<!-- Cuerpo del modal: envuelve el formulario existente -->

<div class="mp-body">

<form [formGroup]="form" (ngSubmit)="onSubmit()">

<div class="mp-field">

<label>Tipo</label>

<div class="radio-group">

<label><input type="radio" formControlName="tipo" value="ENTRADA" [disabled]="soloSalida"> ENTRADA</label>

<label><input type="radio" formControlName="tipo" value="SALIDA"> SALIDA</label>

</div>

</div>

<div class="mp-field">

<label>Producto</label>

<input type="text" formControlName="search" placeholder="Buscar por SKU o nombre">

<div class="results" *ngIf="resultados.length">

<button type="button" *ngFor="let p of resultados" (click)="seleccionar(p)">

{{ p.sku }} - {{ p.nombre }} &nbsp; (Stock: {{ p.stock }})

</button>

</div>

</div>

<div class="mp-field">

<label>Cantidad</label>

<input type="number" min="1" formControlName="cantidad">

</div>

<div class="hint" *ngIf="seleccionado">

Stock actual: <strong>{{ seleccionado?.stock }}</strong>

&nbsp;|&nbsp; Mínimo: <strong>{{ seleccionado?.minimo }}</strong>

&nbsp;|&nbsp; Máximo: <strong>{{ seleccionado?.stockMaximo }}</strong>

</div>

<div class="mp-actions">

<button class="mm-btn ghost" type="button" (click)="onCancel()">Cancelar</button>

<button class="mm-btn primary" type="submit" [disabled]="form.invalid">

Registrar

</button>

</div>

  </form>

  </div>

  </div>